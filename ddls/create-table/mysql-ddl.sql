CREATE TABLE ENCRYPTED_TRANSACTION (ENCODED_PAYLOAD BLOB NOT NULL, HASH VARBINARY(100) NOT NULL, TIMESTAMP BIGINT, PRIMARY KEY (HASH));
CREATE TABLE ENCRYPTED_RAW_TRANSACTION (ENCRYPTED_KEY BLOB NOT NULL, ENCRYPTED_PAYLOAD BLOB NOT NULL, NONCE BLOB NOT NULL, SENDER BLOB NOT NULL, TIMESTAMP BIGINT, HASH VARBINARY(100) NOT NULL, PRIMARY KEY (HASH));
CREATE TABLE ST_TRANSACTION (CIPHER_TEXT BLOB NOT NULL, CIPHER_TEXT_NONCE BLOB NOT NULL, EXEC_HASH BLOB, DATA_ISSUES VARCHAR(255), PRIVACY_MODE TINYINT, RECIPIENT_NONCE BLOB NOT NULL, SENDER_KEY BLOB NOT NULL, TIMESTAMP BIGINT, VALIDATION_STAGE BIGINT, HASH VARCHAR(255) NOT NULL, PRIMARY KEY (HASH));
CREATE INDEX ST_TRANSACTION_VALSTG ON ST_TRANSACTION (VALIDATION_STAGE);
CREATE TABLE ST_AFFECTED_TRANSACTION (SECURITY_HASH BLOB, AFFECTED_HASH VARCHAR(255) NOT NULL, SOURCE_HASH VARCHAR(255) NOT NULL, PRIMARY KEY (AFFECTED_HASH, SOURCE_HASH));
CREATE TABLE ST_TRANSACTION_RECIPIENT (BOX BLOB, INITIATOR TINYINT(1) default 0, HASH VARCHAR(255) NOT NULL, RECIPIENT VARCHAR(255) NOT NULL, PRIMARY KEY (HASH, RECIPIENT));
CREATE TABLE ST_TRANSACTION_VERSION (NANOTIME BIGINT, PAYLOAD BLOB NOT NULL, PRIVACY_MODE TINYINT, TIMESTAMP BIGINT, HASH VARCHAR(255) NOT NULL, RECIPIENT VARCHAR(255) NOT NULL, PRIMARY KEY (HASH, RECIPIENT));
ALTER TABLE ST_AFFECTED_TRANSACTION ADD CONSTRAINT FK_ST_AFFECTED_TRANSACTION_SOURCE_HASH FOREIGN KEY (SOURCE_HASH) REFERENCES ST_TRANSACTION (HASH);
ALTER TABLE ST_TRANSACTION_RECIPIENT ADD CONSTRAINT FK_ST_TRANSACTION_RECIPIENT_HASH FOREIGN KEY (HASH) REFERENCES ST_TRANSACTION (HASH);
ALTER TABLE ST_TRANSACTION_VERSION ADD CONSTRAINT FK_ST_TRANSACTION_VERSION_HASH FOREIGN KEY (HASH) REFERENCES ST_TRANSACTION (HASH);